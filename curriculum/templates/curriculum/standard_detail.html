{% extends "base.html" %}

{% block content %}
<h1>{{ standard.description }}</h1>
<p><strong>Domain:</strong> {{ standard.domain.name }}</p>
<p><strong>Grade:</strong> {{ standard.domain.grade.level }}</p>

<hr>

<h2>Topics</h2>
{% if standard.topics.all %}
    <ul>
    {% for topic in standard.topics.all %}
    <li>
        <strong>{{ topic.title }}</strong><br>
        <p>{{ topic.description }}</p>
    </li>
    {% endfor %}
    </ul>

{% else %}
    <p>No topics yet for this standard</p>
{% endif %}

<hr>

<h2>Lessons</h2>
{% if lessons %}
    <ul>
    {% for lesson in lessons %}
        <li>{{ lesson.title }}</li>
    {% endfor %}
    </ul>
{% else %}
    <p>No lessons available for this standard yet.</p>
{% endif %}

<h2>Practice Skill Sets</h2>
{% for s in skillsets %}
    <li>
        <a href="{% url 'practice:start' s.id %}">{{ s.title }}</a>

        <!-- Live Readiness Button -->
        <button
            hx-get="{% url 'practice:skillset_readiness' s.id %}"
            hx-target="#readiness-status-{{ s.id }}"
            hx-swap="innerHTML"
            style="margin-left: 10px;"
        >
            Check My Readiness
        </button>

        <!-- üì• Target area for live result -->
        <span id="readiness-status-{{ s.id }}" style="margin-left: 10px;"></span>
    </li>
{% endfor %}


<h2>Assessment</h2>
{% if test %}
    {% if test_unlocked %}
        <p><strong>{{ test.title }}</strong></p>
        <a class="btn btn-primary" href="{% url 'assessments:start' test.id %}">Take Test</a>
    {% else %}
        <p>üìå Complete all practice skill sets to unlock the test.</p>
    {% endif %}
{% else %}
    <p>No test available for this standard.</p>
{% endif %}

<!-- Now properly outside the Assessment block -->
<hr>
<a href="{% url 'curriculum:standard_list' standard.domain.grade.level standard.domain.slug %}">
  ‚Üê Back to Standards
</a>

{% endblock %}
